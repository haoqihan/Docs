**温馨提示**：**学会Vim非一日之功，得靠肌肉记忆**

#### 什么是vim

##### 简介

vim是linux、Unix下使用最多的编辑器，vi的改进版，也可能是最难上手的编辑器之一

##### 都21世纪了，为什么还需要学习vim？

- 只要你用服务器，vim就是必备技能
- 后端和运维工程师必须掌握的编辑器，不然服务器上操作很尴尬
- 可以以纯键盘编辑，提升编辑效率

##### 学习vim的痛点：Vim难上手，学习曲线陡

- vim视频学习资料很少，网上很多博客讲的比较零散，不够直观
- 缺少系统的教程，vim命令众多，难以学习和记忆
- Vim学习曲线陡峭，需要较长时间才能上手，劝退很多初学者

##### 如何学习？

- Vim的概念和基本操作，比如移动和增删改查
- 如何配置Vim，编写自己的vimrc文件
- 如何安装和使用插件，无线扩充Vim功能

#### 下载和安装

**windows**

```shell
# 百度下载 https://jingyan.baidu.com/article/49711c61a4bcdefa441b7cee.html
```

**linux**

```shell
# centos 
yum install vim
# ubuntu
sudo apt-get install vim　
```

**mac**

```shell
brew install macvim 
```

### 基本使用

#### 游标移动

按`Esc`进入普通模式，在该模式下使用方向键或者`h`,`j`,`k`,`l`键可以移动游标。

| 按键 | 说明                         |
| ---- | ---------------------------- |
| `h`  | 左                           |
| `l`  | 右（小写L）                  |
| `j`  | 下                           |
| `k`  | 上                           |
| `w`  | 移动到下一个单词首部         |
| `b`  | 移动到上一个单词首部         |
| `e`  | 移动到下一个单词尾部         |
| `gi` | 快速跳转到最近一次编辑的地方 |
|      |                              |

#### 保存退出

从普通模式输入`:`进入命令行模式，输入`wq`回车，保存并退出编辑

以下为其它几种退出方式：

| 命令               | 说明             |
| ------------------ | ---------------- |
| `:q!`              | 强制退出，不保存 |
| `:q`               | 退出             |
| `:wq!`             | 强制保存并退出   |
| `:w <文件路径>`    | 另存为           |
| `:saveas 文件路径` | 另存为           |
| `:x`               | 保存并退出       |
| `:wq`              | 保存并退出       |

**快捷键**

普通模式下输入`Shift+zz`即可保存退出vim

#### Vim模式

- 正常模式 (Normal-mode)
- 插入模式 (Insert-mode)
- 命令模式 (Command-mode)
- 可视模式 (Visual-mode)

##### 正常模式

 正常模式一般用于浏览文件，也包括一些复制、粘贴、删除等操作。这时击键时，一般的键/键组合会被当成功能键，而不会键入对应的字符。在这个模式下，我们可能通过键盘在文本中跳来跳去，跳动的范围从小到大是字符、单词、行、句子、段落和屏幕。启动vim后默认位于正常模式。不论位于什么模式，按下<Esc>键(有时需要按两下）都会进入正常模式。

#####  插入模式

 在正常模式中按下i, I, a, A等键（后面系列文章会详细介绍），会进入插入模式。 现在只用记住按i键会进行插入模式。插入模式中，击键时会写入相应的字符。

##### 命令模式

 在正常模式中，按下：（冒号）键，会进入命令模式。在命令模式中可以执行 一些输入并执行一些vim或插件提供的指令，就像在shell里一样。这些指令包括设置环境、文件操作、调用某个功能等等。

#####  可视模式

 在正常模式按下v, V, <Ctrl>+v，可以进入可视模式。可视模式中的 操作有点像拿鼠标进行操作，选择文本的时候有一种鼠标选择的即视感，有时候会很方便。

#### 插入模式

在普通模式下使用下面的键将进入插入模式，并可以从相应的位置开始输入

| 命令 | 说明                   |
| ---- | ---------------------- |
| `i`  | 在当前光标处进行编辑   |
| `I`  | 在行首插入             |
| `A`  | 在行末插入             |
| `a`  | 在光标后插入编辑       |
| `o`  | 在当前行后插入一个新行 |
| `O`  | 在当前行前插入一个新行 |

#### 命令模式

Normal模式下输入`：`之后执行命令，比如保存退出`:wq`

| 命令             | 说明     |
| ---------------- | -------- |
| `:vs 或 ctrl`    | 竖分屏   |
| `:sp`            | 横分屏   |
| `:% s/foo/bar/g` | 全局替换 |

#### 可视模式

Normal模式下使用v进入visual选择

| 方法      | 说明                     |
| --------- | ------------------------ |
| `v`：小写 | 文本选择是以字符为单位的 |
| `V`：大写 | 文本选择是以行为单位的   |
| `ctrl+v`  | 可以选择一个矩形内的文本 |

#### 正常模式

##### 行移动

| 方法         | 说明                                     |
| ------------ | ---------------------------------------- |
| `f （char）` | 可以移动到char字符上（当前位置向后查找） |
| `F（char）`  | 可以移动到char字符上（当前位置向前查找） |
| `；`         | 下一个所匹配的位置                       |
| `，`         | 上一个所匹配的位置                       |
| `0 或 ^`     | 到达行首                                 |
| `$ 或 g_`    | 到达行尾                                 |

##### 页面移动

| 方法       | 说明                     |
| ---------- | ------------------------ |
| `gg`       | 到达首部                 |
| `G`        | 到达尾部                 |
| `H`        | 跳转到屏幕开头（head）   |
| `M`        | 跳转到屏幕中间（Middle） |
| `L`        | 跳转到屏幕结尾（Lower）  |
| `ctrl + u` | 向上翻页                 |
| `ctrl + f` | 向下翻页                 |
| `zz`       | 把屏幕置为中间           |
| `ctrl + o` | 快速返回上一个位置       |

##### 删除

| 方法  | 说明                        |
| ----- | --------------------------- |
| `x`   | 删除游标所在的字符          |
| `X`   | 删除游标所在的前一个字符    |
| `dd`  | 删除整行                    |
| `dw`  | 删除一个单词                |
| `d^`  | 删除到行首                  |
| `d0`  | 删除到行尾                  |
| `dG`  | 删除到文档尾部              |
| `d1G` | 删除文档首部                |
| `2dd` | 删除2行，所有都可以任意组合 |

##### 修改

| 方法        | 说明                                     |
| ----------- | ---------------------------------------- |
| `rcs`       | 删除一个字符并插入                       |
| `r（char）` | char代表要替换为那个字符                 |
| `cw`        | 替换从光标所在位置后到一个单词结尾的字符 |

##### 查询

| 方法 | 说明                 |
| ---- | -------------------- |
| `/`  | 向后搜索             |
| `？` | 向前搜索             |
| `#`  | 当前所在单词进行匹配 |
| `*`  | 当前所在单词进行匹配 |
| `n`  | 上一个匹配到的单词   |
| `N`  | 下一个匹配到的单词   |

#### 终端下

##### 移动

| 方法       | 说明           |
| ---------- | -------------- |
| `ctrl + a` | 快速移动到开头 |
| `ctrl + e` | 快速移动到结尾 |
| `ctrl + b` | 向前移动       |
| `ctrl + f` | 向后移动       |
|            |                |

##### 删除（终端上好用）

| 方法       | 说明           |
| ---------- | -------------- |
| `ctrl + h` | 删除上一个字符 |
| `ctrl + w` | 删除上一个单词 |
| `ctrl + u` | 删除当前行     |

#### substitute命令允许我们查找并且替换掉文本，并且支持正则

- :[range]s[ubstitute]/{pattern}/{string}/[flags]
- range表示范围，比如：10,20表示10～20行，%表示全部
- pattern是要替换的模式，string是替换后文本
- flags的几个常用标志
  - g（global）标示全局范围内执行
  - c（confirm）表示确认或者拒绝修改
  - n（number）报告匹配到的次数而不替换，可以用来查询匹配次数

------

### buffer window Tab

- Buffer是指打开一个文件的内存缓存区
- 窗口是Buffer可视化的分割区域
- Tab可以组织窗口为一个工作区

#### buffer 什么是缓冲区

- vim打开一个文件后会加载文件内容到缓冲区
- 之后的修改都是针对内存中的缓冲区，并不会直接保存到文件
- 直到我们执行`：w`的时候我们才会把修改内容写入到文件

#### Buffer切换

- 使用`:ls` 会列举当前缓冲区，然后使用`:b n` 跳转到n个缓冲区
- `:bpre` `:bnext ` `:bfirst` `:blast`
- 或者使用`:b buffer_name`加上tab补全来跳转

### window窗口

#### 窗口是可视化的分割区域

- 一个缓冲区可以分割成多个窗口，每个窗口可以打开不同缓冲区
- `<Ctrl + w> s` 水平分割 `<ctrl + w> v` 垂直分割。或者:sp 和:vs

### 如何切换窗口

#### 切换窗口的命令都是使用Ctrl + w 作为前缀

| 命令         | 用途             |
| ------------ | ---------------- |
| <ctrl + w> w | 在窗口间循环切换 |
| <ctrl + w> h | 切换到左边的窗口 |
| <ctrl + w> j | 切换到下边的窗口 |
| <ctrl + w> k | 切换到上边的窗口 |
| <ctrl + w> l | 切换到右边的窗口 |

### 如何重排窗口

#### 重排窗口可以改变窗口的大小`：h` window-resize 查看文档

| 命令               | 用途                       |
| ------------------ | -------------------------- |
| <ctrl + w> =       | 使所有窗口等宽，等高       |
| <ctrl + w> _       | 最大化活动创建的高度       |
| <ctrl + w> \|      | 最大化活动窗口的宽度       |
| [n]<ctrl + w>      | 把活动窗口的高度设为[n]行  |
| [n] <ctrl + w>  \| | 把活动窗口的宽度设为[n] 列 |

### tab（标签页）将窗口分组

#### tab是可以容纳一系列窗口的容器（：h tabpage）

- vim的Tab和其他编辑器不太一样，可以想象成为一个linux的虚拟桌面
- 比如一个Tab全用来编辑python文件，一个Tab全是HTML文件
- 相比较窗口，Tab一般用的比较少，Tab太多管理起来比较麻烦

### Tab（标签页）操作

#### tab使用的不多，简单了解一下常用的操作就好

| 命令                    | 用途                                 |
| ----------------------- | ------------------------------------ |
| :table [dit] {dilename} | 在新标签页打开{filename}             |
| <ctrl + w>  T           | 把当前窗口移到一个新的标签页         |
| :tabc[lose]             | 关闭当前标签页及其中所有窗口         |
| :tabo[nly]              | 只保留活动标签页，关闭所有其他标签页 |
| :tabn [ext] {N}         | 切换到编号为{N}的标签页              |
| :tabn     或 gt         | 切换到下一个标签页                   |
| :tabp      或gT         | 切换到上一个标签页                   |

------

### 文本对象操作方式

- [number] <command> [text object]
- number 表示次数 command表示命令 d（delete） c（change） y（yank）
- text object 是要操作的文本对象，比如单词 w 句子s 段落 p

### vimNormal模式复制粘贴

- normal模式下复制粘贴使用y（yank） 和p（put），剪贴d和p
- 也可以使用v命令选中要复制的地方，y复制，p粘贴
- 配合文本对象，比如使用yiw复制一个单词，yy复制一行

### Insert模式下的复制粘贴

- 这个和其他的文本编辑器差不多，但是粘贴代码有个坑
- 很多人在vimrc中设置了autoindent，粘贴python代码缩进错乱
- 这时候需要使用set paste 和set nopaste 解决

### 深入寄存器

#### vim不适用单一剪粘板进行剪切，粘贴，而是多组寄存

- 通过“{register} 前缀可以指定寄存器，不指定默认使用无名寄存器
- 比如使用”ayiw 复制一个单词到a中，“bdd删除当前行到寄存器b中
- vim中”“表示无名寄存器，缺省使用，”“p 其实等同于p

### 其他常见寄存器

#### 除了有名的a-z，vim中还有其他常见的寄存器

- 复制专用寄存器，”0 使用y复制文本同时会被拷贝到寄存器0
- 系统剪切板，“+ 可以在复制前加上，”+ 复制到系统剪切板
- 其他一些寄存器比如“% 当前文件名，”. 上次插入的文本

### 如何使用宏

#### 宏的使用分为录制和回放

- vim使用q来录制，同时q结束录制
- 使用q{register}选择要保存的寄存器，把录制的命令保存其中
- 使用@{register}回放寄存器中保存的一些列操作

### vim补全大法

#### 只要手速快，补全什么都是浮云

- 补全是根据当前环境上下文编辑器【猜】你想输入的东西
- 比如补全一个单词，文件名，或者代码中的函数名，变量名
- vim中提供了多种补全功能，还可以使用插件来拓展

#### vim中有很多种补全方式

| 命令            | 补全类型         |
| --------------- | ---------------- |
| <C - n>         | 普通关键字       |
| <C - x> <C - n> | 当前缓冲区关键字 |
| <C - x> <C - i> | 包含文件关键字   |
| <C - x> <C - ]> | 标签文件关键字   |
| <C - x><C - k>  | 字典查找         |
| <C - x> <C - l> | 整行补全         |
| <C - x> <C - f> | 文件名补全       |
| <C - x> <C - o> | 全能补全         |

### 常见的三种补全类型

#### 最常见的有三种

- 使用ctrl + n和ctrl + p补全单词
- 使用ctrl + x ctrl + f补全文件名
- 使用ctrl + x ctrl + o 补全代码，需要开启文件类型查看，安装插件

------

### vim更换配色

#### 很多现代化的编辑器和IDE都支持更换主题，Vim当然也一样

- 使用：colorscheme 显示当前的主题颜色，默认是default
- 用:colorscheme <ctrl + d> 可以显示所有配色
- 用：colorscheme 配色名，就可以更换配色





































